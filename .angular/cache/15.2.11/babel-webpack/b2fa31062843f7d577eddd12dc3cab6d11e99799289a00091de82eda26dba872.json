{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class CartService {\n  constructor() {\n    this.storageKey = 'cart';\n    this.cartItemsSource = new BehaviorSubject(this.loadCart());\n    this.cartItems$ = this.cartItemsSource.asObservable();\n  }\n  loadCart() {\n    try {\n      return JSON.parse(localStorage.getItem(this.storageKey) || '[]');\n    } catch {\n      return [];\n    }\n  }\n  saveCart(items) {\n    // ensure we save a new array reference\n    const copy = items.map(i => ({\n      ...i\n    }));\n    localStorage.setItem(this.storageKey, JSON.stringify(copy));\n    this.cartItemsSource.next(copy);\n  }\n  addToCart(product, qty) {\n    const items = this.loadCart();\n    const index = items.findIndex(x => x.id === product.id);\n    if (index > -1) {\n      // exists -> update quantity\n      items[index].quantity = (items[index].quantity || 0) + qty;\n    } else {\n      const newItem = {\n        ...product,\n        quantity: qty\n      };\n      items.push(newItem);\n    }\n    this.saveCart(items);\n  }\n  clearCart() {\n    this.saveCart([]);\n  }\n  // helper to get current snapshot (not observable)\n  getCartSnapshot() {\n    return this.cartItemsSource.getValue();\n  }\n}\nCartService.ɵfac = function CartService_Factory(t) {\n  return new (t || CartService)();\n};\nCartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CartService,\n  factory: CartService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AACA,SAASA,eAAe,QAAQ,MAAM;;AAKtC,OAAM,MAAOC,WAAW;EAKtBC;IAJQ,eAAU,GAAG,MAAM;IACnB,oBAAe,GAAG,IAAIF,eAAe,CAAQ,IAAI,CAACG,QAAQ,EAAE,CAAC;IACrE,eAAU,GAAG,IAAI,CAACC,eAAe,CAACC,YAAY,EAAE;EAEjC;EAEPF,QAAQ;IACd,IAAI;MACF,OAAOG,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACC,UAAU,CAAC,IAAI,IAAI,CAAC;KACjE,CAAC,MAAM;MACN,OAAO,EAAE;;EAEb;EAEAC,QAAQ,CAACC,KAAY;IACnB;IACA,MAAMC,IAAI,GAAGD,KAAK,CAACE,GAAG,CAACC,CAAC,KAAK;MAAE,GAAGA;IAAC,CAAE,CAAC,CAAC;IACvCP,YAAY,CAACQ,OAAO,CAAC,IAAI,CAACN,UAAU,EAAEJ,IAAI,CAACW,SAAS,CAACJ,IAAI,CAAC,CAAC;IAC3D,IAAI,CAACT,eAAe,CAACc,IAAI,CAACL,IAAI,CAAC;EACjC;EAEAM,SAAS,CAACC,OAAY,EAAEC,GAAW;IACjC,MAAMT,KAAK,GAAG,IAAI,CAACT,QAAQ,EAAE;IAC7B,MAAMmB,KAAK,GAAGV,KAAK,CAACW,SAAS,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKL,OAAO,CAACK,EAAE,CAAC;IAEvD,IAAIH,KAAK,GAAG,CAAC,CAAC,EAAE;MACd;MACAV,KAAK,CAACU,KAAK,CAAC,CAACI,QAAQ,GAAG,CAACd,KAAK,CAACU,KAAK,CAAC,CAACI,QAAQ,IAAI,CAAC,IAAIL,GAAG;KAC3D,MAAM;MACL,MAAMM,OAAO,GAAG;QAAE,GAAGP,OAAO;QAAEM,QAAQ,EAAEL;MAAG,CAAE;MAC7CT,KAAK,CAACgB,IAAI,CAACD,OAAO,CAAC;;IAGrB,IAAI,CAAChB,QAAQ,CAACC,KAAK,CAAC;EACtB;EAEAiB,SAAS;IACP,IAAI,CAAClB,QAAQ,CAAC,EAAE,CAAC;EACnB;EAEA;EACAmB,eAAe;IACb,OAAO,IAAI,CAAC1B,eAAe,CAAC2B,QAAQ,EAAE;EACxC;;AA5CW9B,WAAW;mBAAXA,WAAW;AAAA;AAAXA,WAAW;SAAXA,WAAW;EAAA+B,SAAX/B,WAAW;EAAAgC,YAFV;AAAM","names":["BehaviorSubject","CartService","constructor","loadCart","cartItemsSource","asObservable","JSON","parse","localStorage","getItem","storageKey","saveCart","items","copy","map","i","setItem","stringify","next","addToCart","product","qty","index","findIndex","x","id","quantity","newItem","push","clearCart","getCartSnapshot","getValue","factory","providedIn"],"sourceRoot":"","sources":["E:\\store-page\\src\\app\\service\\cart.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CartService {\n  private storageKey = 'cart';\n  private cartItemsSource = new BehaviorSubject<any[]>(this.loadCart());\n  cartItems$ = this.cartItemsSource.asObservable();\n\n  constructor() {}\n\n  private loadCart(): any[] {\n    try {\n      return JSON.parse(localStorage.getItem(this.storageKey) || '[]');\n    } catch {\n      return [];\n    }\n  }\n\n  saveCart(items: any[]) {\n    // ensure we save a new array reference\n    const copy = items.map(i => ({ ...i }));\n    localStorage.setItem(this.storageKey, JSON.stringify(copy));\n    this.cartItemsSource.next(copy);\n  }\n\n  addToCart(product: any, qty: number) {\n    const items = this.loadCart();\n    const index = items.findIndex(x => x.id === product.id);\n\n    if (index > -1) {\n      // exists -> update quantity\n      items[index].quantity = (items[index].quantity || 0) + qty;\n    } else {\n      const newItem = { ...product, quantity: qty };\n      items.push(newItem);\n    }\n\n    this.saveCart(items);\n  }\n\n  clearCart() {\n    this.saveCart([]);\n  }\n\n  // helper to get current snapshot (not observable)\n  getCartSnapshot(): any[] {\n    return this.cartItemsSource.getValue();\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}